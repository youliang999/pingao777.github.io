<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>大道至简：朴素贝叶斯分类器 | 瞎说</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="万物之始,大道至简,衍化至繁。 　　　　　　　——ifelse(is.element(this, 道德经), 道德经, unknown)  一、背景提到贝叶斯分类，首先来看下贝叶斯其人，贝叶斯(Thomas Bayes,1701—1761)英国牧师、业余数学家。可别小看了欧洲的牧师，孟德尔，被誉为“遗传学之父”也曾为一名神父，假如你不记得孟德尔是谁，那么你肯定记得高中生物上那个著名的豌豆实验。">
<meta name="keywords" content="机器学习,贝叶斯">
<meta property="og:type" content="article">
<meta property="og:title" content="大道至简：朴素贝叶斯分类器">
<meta property="og:url" content="https://pingao777.github.io/2017/11/16/大道至简：朴素贝叶斯分类器/index.html">
<meta property="og:site_name" content="瞎说">
<meta property="og:description" content="万物之始,大道至简,衍化至繁。 　　　　　　　——ifelse(is.element(this, 道德经), 道德经, unknown)  一、背景提到贝叶斯分类，首先来看下贝叶斯其人，贝叶斯(Thomas Bayes,1701—1761)英国牧师、业余数学家。可别小看了欧洲的牧师，孟德尔，被誉为“遗传学之父”也曾为一名神父，假如你不记得孟德尔是谁，那么你肯定记得高中生物上那个著名的豌豆实验。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://img.blog.csdn.net/20151011083844295">
<meta property="og:image" content="http://img.blog.csdn.net/20151011085611777">
<meta property="og:image" content="http://img.blog.csdn.net/20151011130237290">
<meta property="og:image" content="http://img.blog.csdn.net/20151011131531727">
<meta property="og:image" content="http://img.blog.csdn.net/20151011131845212">
<meta property="og:updated_time" content="2018-01-11T14:00:11.204Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大道至简：朴素贝叶斯分类器">
<meta name="twitter:description" content="万物之始,大道至简,衍化至繁。 　　　　　　　——ifelse(is.element(this, 道德经), 道德经, unknown)  一、背景提到贝叶斯分类，首先来看下贝叶斯其人，贝叶斯(Thomas Bayes,1701—1761)英国牧师、业余数学家。可别小看了欧洲的牧师，孟德尔，被誉为“遗传学之父”也曾为一名神父，假如你不记得孟德尔是谁，那么你肯定记得高中生物上那个著名的豌豆实验。">
<meta name="twitter:image" content="http://img.blog.csdn.net/20151011083844295">
    

    

    
        <link rel="icon" href="/favicon.ico" />
    

    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>
    
    
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-44085500-1', 'auto');
ga('send', 'pageview');

</script>
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">瞎说</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">主页</a>
                
                    <a class="main-nav-link" href="/archives">时间线</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于我</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">主页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">时间线</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于我</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.png" />
            <h2 id="name">pingao777</h2>
            <h3 id="title">Web Developer &amp; Designer</h3>
            <span id="location"><i class="fa fa-map-marker"></i>北京</span>
            <a id="follow" target="_blank" href="http://github.com/pingao777">关注我</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                16
                <span>文章</span>
            </div>
            <div class="article-info-block">
                21
                <span>标签</span>
            </div>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-大道至简：朴素贝叶斯分类器" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            大道至简：朴素贝叶斯分类器
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/16/大道至简：朴素贝叶斯分类器/">
            <time datetime="2017-11-16T13:41:58.000Z" itemprop="datePublished">2017-11-16</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术人生/">技术人生</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/机器学习/">机器学习</a>, <a class="tag-link" href="/tags/贝叶斯/">贝叶斯</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>万物之始,大道至简,衍化至繁。</p>
<p>　　　　　　　——ifelse(is.element(this, 道德经), 道德经, unknown)</p>
</blockquote>
<p>一、背景<br>提到贝叶斯分类，首先来看下贝叶斯其人，贝叶斯(Thomas Bayes,1701—1761)英国牧师、业余数学家。可别小看了欧洲的牧师，孟德尔，被誉为“遗传学之父”也曾为一名神父，假如你不记得孟德尔是谁，那么你肯定记得高中生物上那个著名的豌豆实验。</p>
<a id="more"></a>
<p>具有讽刺意味的是，当初贝叶斯发明概率统计理论是为了证明上帝的存在，而至死这个愿望都没有实现，不过感谢伟大的贝叶斯，因为他的无心插柳，才有了今天的贝叶斯公式。接下来，来一睹贝叶斯公式的风采，</p>
<p>$$P(B|A)=\frac{P(B)P(A|B)}{P(A)}$$</p>
<p>公式看起来是不是很简洁，看起来很有对称美。记得上学那会数学老师的一句话，假如你算出来的答案不够简洁，那么多半这道题你算错了。贝叶斯公式有什么意义呢？<strong>它解决了两个事件条件概率的转换问题</strong>。比如说，已知感冒导致流鼻涕的概率，那么流鼻涕有多大的概率感冒呢？贝叶斯可以解决这类问题。</p>
<p>二、贝叶斯分类</p>
<p>贝叶斯可以解决条件概率转换，可是它怎么与分类联系起来的呢？</p>
<p>让我以一个例子加以说明，假设有这样一个数据集（本例来自<a href="http://www.ruanyifeng.com/blog/2013/12/naive_bayes_classifier.html" target="_blank" rel="external">朴素贝叶斯分类器的应用</a>），</p>
<blockquote>
<p>症状(A1) 职业(A2)　疾病(B)<br>打喷嚏　  护士　　　感冒<br>打喷嚏　  农夫　　　过敏<br>头痛　　  建筑工人　脑震荡<br>头痛　　  建筑工人　感冒<br>打喷嚏　  教师　　　感冒<br>头痛　　  教师　　　脑震荡</p>
</blockquote>
<p>那么一个打喷嚏的建筑工人是感冒还是没感冒呢？<br>根据贝叶斯定理，</p>
<blockquote>
<p>P(感冒|打喷嚏x建筑工人) = P(打喷嚏x建筑工人|感冒) x P(感冒) / P(打喷嚏x建筑工人)</p>
<p>假定”打喷嚏”和”建筑工人”这两个特征是独立的，因此，上面的等式就变成了</p>
<p>P(感冒|打喷嚏x建筑工人) = P(打喷嚏|感冒) x P(建筑工人|感冒) x P(感冒) / P(打喷嚏) x P(建筑工人) = 0.66 x 0.33 x 0.5 / 0.5 x 0.33 = 0.66<br>同理，<br>P(非感冒|打喷嚏x建筑工人) = P(打喷嚏|非感冒) x P(建筑工人|非感冒) x P(非感冒) / P(打喷嚏) x P(建筑工人) = 0.33 x 0.33 x 0.5 / 0.5 x 0.33 = 0.33</p>
<p>因为P(感冒|打喷嚏x建筑工人)  &gt; P(非感冒|打喷嚏x建筑工人) ，所以我们更愿意相信一个打喷嚏的建筑工人是感冒的。</p>
</blockquote>
<p>从上面的例子可以看出，贝叶斯分类的步骤是这样的：</p>
<ol>
<li>设$x = {a_1,a_2,\cdots}$为一个待分类项，每个a为x的一个特征属性。</li>
<li>有类别集合$C = {y_1,y_2,\cdots,y_n}$.</li>
<li>根据训练集计算，$P(y_1|x), P(y_2|x),\cdots,P(y_n|x)$.</li>
<li>如果$P(y_k|x)=max{P(y_1|x), P(y_2|x),\cdots,P(y_n|x)}$，则$x$的分类为$y_k$。</li>
</ol>
<p>说到贝叶斯分类，还有几个需要注意的问题：</p>
<ol>
<li>如果已知条件不止一个属性，二是多个呢，这个时候贝叶斯公式可以写作$$P(y|a_1a_2\cdots)=\frac{P(y)P(a_1a_2\cdots|y)}{P(a_1a_2\cdots)}=\frac{P(y)P(a_1|y)P(a_2|y)\cdots}{P(a_1)P(a_2)\cdots}$$上述公式假设特征属性$a_1,a_2\cdots$相互独立，这也是“朴素”一词的由来。另外，可以看到对于不同的分类，分母都是恒定的，而我们只想找到概率最大的类别，因此可以把分母省略，求条件概率的相对值，$$P(y|a_1a<em>2\cdots)</em>{relative}=P(y)P(a_1|y)P(a_2|y)\cdots$$</li>
<li>不知道大家有没有注意到，上面的已知条件都是离散值，如果是连续值呢，对于连续值通常有两种办法，一是将连续值截取为离散值，然后求概率，二是假定离散值服从高斯分布，即$$f(x)=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(x-\mu)^2}{2\sigma^2})$$因为我们只需求概率的相对值，所以这里只需计算属性的概率密度值即可。</li>
<li>还有一个问题，当某些类别下某个特征值计数为0，即$P(a_i|y_j)$=0，这会使某些分类最终的概率为0，会降低分类器的准确性，为了解决这个问题，引入Laplace校准，就是对这些类别的某些特征值计数加1，这样如果训练样本集数量充分大时，并不会对结果产生影响。</li>
</ol>
<p>如果想更详细的了解贝叶斯分类，请参考这两篇文章<a href="http://www.cnblogs.com/leoo2sk/archive/2010/09/17/naive-bayesian-classifier.html" target="_blank" rel="external">分类算法之朴素贝叶斯分类</a>和<a href="http://www.ruanyifeng.com/blog/2013/12/naive_bayes_classifier.html" target="_blank" rel="external">朴素贝叶斯分类器的应用</a>。</p>
<p>接下来，我用R语言实现一个分类器并用一些数据集测试分类效果。</p>
<p>三、算法实现</p>
<p>程序主要由三部分组成：</p>
<p>分类器主要由下面几个函数组成，具体的代码见<a href="https://github.com/pingao777" target="_blank" rel="external">GitHub</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 1.求各个分类概率P(ycol)</span><br><span class="line">get.ytable &lt;- function(ycol, trainset)</span><br><span class="line"># 2.1求离散属性xcol的条件概率P(xcol|ycol)</span><br><span class="line">get.discrete.xtable &lt;- function(xcol, ycol, trainset) </span><br><span class="line"># 2.2求连续属性xcol的概率密度，假设服从高斯分布</span><br><span class="line">get.continout.xdensity &lt;- function(xcol, ycol, trainset)</span><br><span class="line"># 3.对于某些概率为零的类别，采用Laplace校准设置默认值</span><br><span class="line">get.defaultx &lt;- function(ycol, trainset)</span><br><span class="line"># 注：xcol特征属性，ycol类别属性，trainset训练集</span><br></pre></td></tr></table></figure>
<p>下面以基础包里的<em>iris</em><a href="iris以鸢尾花的特征作为数据来源，该数据集共150条数据，包含了5个属性：Sepal.Length（花萼长度），Sepal.Width（花萼宽度），Petal.Length（花瓣长度），Petal.Width（花瓣宽度），种类">^iris</a>数据集验证一下分类器的效果，选取前四列为特征，预测鸢尾花的种类，</p>
<p><img src="http://img.blog.csdn.net/20151011083844295" alt=""></p>
<p>图上有两条曲线，黑色为我实现的贝叶斯分类器，红色虚线为<em>e1071</em>包里的一个贝叶斯分类器实现。观察可得，随着训练集样本数的增加，测试集的分类正确率越来越高。</p>
<p>再来看看特征属性的选取对正确率的影响，</p>
<p><img src="http://img.blog.csdn.net/20151011085611777" alt=""></p>
<p>这次只选择了第二列（花萼宽度）作为特征值，可以看到正确率明显下降了。</p>
<p>再来看一个多分类问题，采用<a href="https://pingao777.github.io/2017/11/16/%E5%BD%93Python%E5%92%8CR%E9%81%87%E4%B8%8A%E5%8C%97%E4%BA%AC%E4%BA%8C%E6%89%8B%E6%88%BF%EF%BC%88%E4%B8%8A%EF%BC%89/">北京二手房</a>这个数据集，</p>
<p><img src="http://img.blog.csdn.net/20151011130237290" alt=""></p>
<p>通过房价和是否学区这两列来预测房子所在的区，可以看到这两个特征属性的预测正确率稳定在0.4左右，下面再添加户型、朝向、楼层三列，</p>
<p><img src="http://img.blog.csdn.net/20151011131531727" alt=""></p>
<p>上图显示，添加了三个特征属性后，正确率并没有明显的改善，但是如果再添加一个区域列(con)，</p>
<p><img src="http://img.blog.csdn.net/20151011131845212" alt=""></p>
<p>由图观察，添加了区域这一列后，正确率得到了大幅度的提升，事实上仅保留区域这一列，预测的正确率也很高，这是因为区域(con)与区(area)的相关性较强。</p>
<p>根据我实验的结果，通常情况下，提高预测正确率的方法有两种：</p>
<ol>
<li>增加训练集样本数，但是样本到达一定的数目正确率就保持稳定，很难再提高了。</li>
<li>选取恰当的特征，注意单纯的增加特征数目并不能提高正确率，反而会引入更多的误差造成过拟合。</li>
</ol>

        
        </div>
        <footer class="article-footer">
            
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2017/11/16/当Python和R遇上北京二手房（上）/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">上一篇</strong>
            <div class="article-nav-title">
                
                    当Python和R遇上北京二手房（上）
                
            </div>
        </a>
    
    
        <a href="/2017/11/16/他们征友（婚）时，他们征什么？/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">下一篇</strong>
            <div class="article-nav-title">他们征友（婚）时，他们征什么？</div>
        </a>
    
</nav>


    
</article>


    
    
        <section id="comments">
    <div id="valine-thread"></div>
</section>
    


</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/七七八八/">七七八八</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术人生/">技术人生</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活生活/">生活生活</a><span class="category-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">10</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/2018/" style="font-size: 10px;">2018</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Maven/" style="font-size: 10px;">Maven</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/R/" style="font-size: 20px;">R</a> <a href="/tags/Vim/" style="font-size: 15px;">Vim</a> <a href="/tags/alpha-beta/" style="font-size: 10px;">alpha-beta</a> <a href="/tags/minimax/" style="font-size: 10px;">minimax</a> <a href="/tags/五子棋/" style="font-size: 10px;">五子棋</a> <a href="/tags/侏罗纪公园/" style="font-size: 10px;">侏罗纪公园</a> <a href="/tags/决策树/" style="font-size: 10px;">决策树</a> <a href="/tags/数据挖掘/" style="font-size: 10px;">数据挖掘</a> <a href="/tags/日志/" style="font-size: 10px;">日志</a> <a href="/tags/机器学习/" style="font-size: 20px;">机器学习</a> <a href="/tags/泛型/" style="font-size: 10px;">泛型</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/统计/" style="font-size: 20px;">统计</a> <a href="/tags/计划/" style="font-size: 10px;">计划</a> <a href="/tags/贝叶斯/" style="font-size: 10px;">贝叶斯</a> <a href="/tags/随机森林/" style="font-size: 10px;">随机森林</a>
        </div>
    </div>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2018 pingao777<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        
    
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.6/dist/Valine.min.js"></script>
    <script>
        new Valine({
            el: '#valine-thread' ,
            notify:false,
            verify:false,
            app_id: '0uUtzN1bmW45lEsXVGDMaekE-gzGzoHsz',
            app_key: 'SiD0cv45eP3ptV9yXuif6K9V',
            placeholder: '只会玩白牛.....'
        });
    </script>




    
    
    
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>